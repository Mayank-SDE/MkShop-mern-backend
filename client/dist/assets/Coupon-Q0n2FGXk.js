import{v as P,w as G,x as z,r as a,j as e,_ as r,N as R}from"./index-BGOoP327.js";import{T as O,a as Q}from"./TableSkeleton-DgHVCAiu.js";import{f as q}from"./date-D1yCoplD.js";import"./index-DUXrVzM3.js";import"./iconBase-DY2o13lj.js";const B=[{Header:"ID",accessor:"_id"},{Header:"Coupon",accessor:"coupon"},{Header:"Amount",accessor:"amount"},{Header:"Date",accessor:"date"},{Header:"Action",accessor:"action"}],J="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",K="0123456789",U="!@#$%^&*()_+",$=()=>{const{isLoading:g,data:n,isError:j,refetch:m}=P(),[y]=G(),[C]=z(),[p,N]=a.useState([]),[c,v]=a.useState(8),[f,w]=a.useState(""),[i,S]=a.useState(!1),[u,k]=a.useState(!1),[d,T]=a.useState(!1),[H,h]=a.useState(!1),[b,A]=a.useState(0),[x,I]=a.useState("");a.useEffect(()=>{n&&N(n.coupons.map(t=>({_id:t._id,coupon:t.coupon,amount:t.amount,date:q(t.createdAt),action:e.jsx("button",{onClick:()=>D(t._id),className:"bg-red-500 px-3 py-1 hover:bg-red-600 rounded-full font-semibold text-slate-100",children:"Delete"})})))},[n]);const D=async t=>{try{const s=await y(t).unwrap();s.success?(r.success(s.message),m()):r.error(s.message)}catch(s){console.error(s),r.error("Coupon deletion failed. Please try again.")}},E=async t=>{if(t.preventDefault(),!i&&!u&&!d){r.error("Please select at least one option: numbers, characters, or symbols.");return}let s=f||"";const L=c-s.length;for(let o=0;o<L;o++){let l="";u&&(l+=J),i&&(l+=K),d&&(l+=U);const M=Math.floor(Math.random()*l.length);s+=l[M]}I(s),h(!1);try{const o=await C({coupon:s,amount:b}).unwrap();o.success?(r.success(o.message),m()):r.error(o.message)}catch(o){console.error(o),r.error("Coupon generation failed. Please try again.")}},_=async t=>{await navigator.clipboard.writeText(t),h(!0)};if(j)return e.jsx(R,{to:"/admin/dashboard"});const F=O(B,p,"bg-slate-100 text-slate-900 dark:bg-slate-900 dark:text-slate-100 w-full overflow-x-auto h-[500px] mt-4","Coupons",p.length>6);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col justify-center mt-6 items-center gap-4 w-full",children:[e.jsx("div",{className:"text-lg font-bold",children:"Coupon Generator"}),e.jsx("div",{className:"sm:w-[50%] border-slate-500 border-2 rounded-2xl h-fit p-4 w-full",children:e.jsxs("form",{onSubmit:E,className:"flex justify-center flex-col gap-4 items-center",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center gap-2",children:[e.jsxs("div",{className:"flex flex-wrap gap-2 items-center justify-center",children:[e.jsx("label",{htmlFor:"textToInclude",className:"text-sm font-semibold",children:"Text to include:"}),e.jsx("input",{className:"text-xs border dark:text-slate-900 border-slate-500 p-2 rounded-xl",type:"text",id:"textToInclude",placeholder:"Text to include",value:f,onChange:t=>w(t.target.value),maxLength:c})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 items-center justify-center",children:[e.jsx("label",{htmlFor:"couponLength",className:"text-sm font-semibold",children:"Coupon length:"}),e.jsx("input",{className:"border dark:text-slate-900 text-xs border-slate-500 py-1 px-4 rounded-xl",type:"number",id:"couponLength",value:c,placeholder:"Enter coupon length",onChange:t=>v(Number(t.target.value)),min:8,max:25})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 items-center justify-center",children:[e.jsx("label",{htmlFor:"include",className:"text-sm font-semibold",children:"Include:"}),e.jsxs("div",{className:"text-xs flex gap-1",children:[e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",onChange:()=>k(t=>!t),checked:u})," Characters"]}),e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",onChange:()=>S(t=>!t),checked:i})," Numbers"]}),e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",onChange:()=>T(t=>!t),checked:d})," Symbols"]})]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 items-center justify-center",children:[e.jsx("label",{htmlFor:"couponAmount",className:"text-sm font-semibold",children:"Amount:"}),e.jsx("input",{className:"border dark:text-slate-900 text-xs border-slate-500 p-2 rounded-xl",type:"number",id:"couponAmount",value:b,placeholder:"Enter coupon worth",onChange:t=>A(Number(t.target.value)),min:1,max:1e5})]}),e.jsx("button",{className:"bg-blue-500 px-3 py-1 w-fit mt-3 rounded-full text-sm text-slate-100 hover:scale-110",type:"submit",children:"Generate"}),x&&e.jsxs("div",{className:"flex flex-col gap-2 justify-center items-center",children:[e.jsx("div",{className:"font-mono text-sm text-slate-500",children:x}),e.jsx("button",{type:"button",className:"bg-slate-900 dark:bg-slate-100 dark:text-slate-900 text-slate-100 px-3 w-fit text-sm font-mono rounded-3xl",onClick:()=>_(x),children:H?"Copied":"Copy"})]})]})})]}),g?e.jsx(Q,{}):e.jsx(F,{})]})};export{$ as default};
